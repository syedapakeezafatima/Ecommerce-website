<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Grid</title>
    <link rel="stylesheet" href="stylesC.css"> <!-- Link to your CSS file -->
</head>
<body>
    <header>
        <div class="header-content">
            <nav class="navbar">
                <a href="#">SAVE MORE ON APP</a>
                <a href="#">Sell ON DARAZ</a>
                <a href="#">HELP & SUPPORT</a>
                <a href="#">LOGIN</a>
                <a href="#">SIGN UP</a>
                <a href="#">زبان تبدیل کریں</a>
            </nav>
        </div>
        <div class="search-container">
            <div class="logo">
                <img src="daraz 2.png" alt="Daraz Logo" class="logo-img">
            </div>
            <input type="text" placeholder="Search in Daraz" class="search-bar">
            <button class="search-button">
                <img src="icon (2).png" alt="Search Icon" class="search-icon">
            </button>
            <a href="#" class="cart-icon">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="50" height="50" viewBox="0 0 48 48">
                    <path d="M 3.5 6 A 1.50015 1.50015 0 1 0 3.5 9 L 6.2558594 9 C 6.9837923 9 7.5905865 9.5029243 7.7285156 10.21875 L 8.0273438 11.78125 L 11.251953 28.716797 C 11.835068 31.772321 14.527135 34 17.638672 34 L 36.361328 34 C 39.472865 34 42.166064 31.773177 42.748047 28.716797 L 45.972656 11.78125 A 1.50015 1.50015 0 0 0 44.5 10 L 10.740234 10 L 10.675781 9.6582031 C 10.272657 7.5455321 8.4069705 6 6.2558594 6 L 3.5 6 z M 11.3125 13 L 42.6875 13 L 39.800781 28.15625 C 39.484764 29.81587 38.051791 31 36.361328 31 L 17.638672 31 C 15.948808 31 14.516781 29.8158 14.199219 28.15625 L 14.199219 28.154297 L 11.3125 13 z M 20 36 A 3 3 0 0 0 20 42 A 3 3 0 0 0 20 36 z M 34 36 A 3 3 0 0 0 34 42 A 3 3 0 0 0 34 36 z"></path>
                </svg>
            </a>
        </div>
        <div class="search-suggestions">
            <a href="#">bags for girls</a> <span class="separator">|</span>
            <a href="#">water bottle</a> <span class="separator">|</span>
            <a href="#">smart watch</a> <span class="separator">|</span>
            <a href="#">makeup</a> <span class="separator">|</span>
            <a href="#">laptop</a>
        </div>
    </header>
<div class="products-section">
    <div id="product-heading">
        <h2>Available Products</h2> <!-- Optional heading for the section -->
    </div>

    <div class="products-grid"></div>

    <!-- New div to hold the product details dynamically -->
    <div id="product-details-section"></div>
</div>

<script>
   document.addEventListener('DOMContentLoaded', async () => {
    const productsGrid = document.querySelector('.products-grid');

    // Function to display the products
    const displayProducts = (products) => {
        productsGrid.innerHTML = '';  // Clear any previous content

        products.forEach(product => {
            const rating = product.rating && product.rating.rate ? Math.round(product.rating.rate) : 0;
            const productHTML = `
                <div class="product-item" data-id="${product.id}">
                    <img src="${product.image}" alt="${product.title}">
                    <p>${product.title}</p>
                    <p class="price">$${product.price}</p>
                    <div class="rating" style="color: yellow; font-size: 16px">
                        ${'★'.repeat(rating)}
                    </div>
                </div>
            `;
            productsGrid.innerHTML += productHTML;
        });

        // Add click event listener for each product to load product details dynamically
        document.querySelectorAll('.product-item').forEach(item => {
            item.addEventListener('click', async () => {
                const productId = item.getAttribute('data-id');
                await loadProductDetails(productId);  // Load product details dynamically
            });
        });
    };

    // Function to dynamically load product details
    const loadProductDetails = async (productId) => {
        const productDetailsSection = document.getElementById('product-details-section');
        
        // Clear the product grid and hide the heading
        productsGrid.innerHTML = '';
        document.getElementById('product-heading').style.display = 'none';  // Hide the heading

        try {
            const response = await fetch(`product.html`);
            const html = await response.text();  // Fetch the HTML content of product.html
            productDetailsSection.innerHTML = html;  // Inject the content into the page

            // Fetch the actual product details
            const productResponse = await fetch(`https://fakestoreapi.com/products/${productId}`);
            const product = await productResponse.json();

            // Ensure DOM is ready before updating product details
            document.querySelector('.product-name').textContent = product.title;
            document.querySelector('.current-price').textContent = `Rs. ${product.price}`;
            document.querySelector('.product-image').src = product.image;
        } catch (error) {
            console.error('Error loading product details:', error);
        }
    };

    // Fetch products based on the selected category
    const selectedCategory = localStorage.getItem('selectedCategory');
    if (selectedCategory) {
        try {
            const apiUrl = `https://fakestoreapi.com/products/category/${encodeURIComponent(selectedCategory)}`;
            const response = await fetch(apiUrl);
            if (!response.ok) throw new Error('Failed to fetch products');
            const products = await response.json();
            displayProducts(products);
        } catch (error) {
            console.error('Error fetching products:', error);
        }
    } else {
        productsGrid.innerHTML = '<p>No category selected. Please go back and select a category.</p>';
    }
});
</script>

</body>
</html>
